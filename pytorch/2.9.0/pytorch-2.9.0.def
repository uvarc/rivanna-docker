Bootstrap: docker
From: nvcr.io/nvidia/pytorch:25.10-py3

%post
    # dependencies for openslide, opencv, poppler
    apt-get update
    apt-get install -y --no-install-recommends \
        openslide-tools \
        libgl1 libsm6 libxext6 libxrender1 libgtk-3-dev libavcodec-dev libavformat-dev libswscale-dev \
        libpoppler-cpp-dev
    rm -rf /var/lib/apt/lists/*

    pip install --no-cache-dir \
        seaborn==0.13.2 \
        scikit-image==0.25.2 \
        openslide-python==1.4.2 \
        opencv-python==4.12.0.88 \
        lightning==2.5.5 \
        torch-geometric==2.7.0 \
        python-poppler==0.4.1 \
        pyqt6==6.10.0 \
        datasets==4.3.0 \
        sox ipywidgets 

%runscript
    /opt/nvidia/nvidia_entrypoint.sh python "$@"

%labels
    Maintainer rs7wz@virginia.edu
