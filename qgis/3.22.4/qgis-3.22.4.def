# RIV-12180
Bootstrap: docker
From: ubuntu:22.04

%post
    apt-get update
    apt-get install -y --no-install-recommends \
        wget ca-certificates \
        qgis qgis-plugin-grass \
        openmpi-bin
    rm -rf /var/lib/apt/lists/*

# SWAT
    wget https://plus.swat.tamu.edu/downloads/2.3/2.3.1/swatplus-linux-installer-2.3.1.tgz
    rm -rf /var/lib/apt/lists/*
    tar xf swatplus-linux-installer-2.3.1.tgz
    ./installforall.sh
    rm *.sh

    chmod -R o+rx /usr/share/qgis/python/plugins/QSWATPlusLinux3_64

# https://stackoverflow.com/questions/63627955/cant-load-shared-library-libqt5core-so-5
    strip --remove-section=.note.ABI-tag /usr/lib/x86_64-linux-gnu/libQt5Core.so.5

%runscript
    exec qgis "$@"

%environment
    export QSWAT_PROJECT=/usr/share/qgis/python/plugins/QSWATPlusLinux3_64

%labels
    Maintainer rs7wz@virginia.edu
